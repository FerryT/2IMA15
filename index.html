<html>
<head>
	<title>Duality Force</title>
	<script src="jquery-2.1.4.min.js"></script>
	<script src="jquery.scrollTo.min.js"></script>
	<script src="jquery.waypoints.min.js"></script>
	<script src="d3.min.js" charset="utf-8"></script>
	<script src="geometry.js"></script>
	<script src="behavior.js"></script>
	<script src="behavior2.js"></script>
	<script src="ai.js"></script>
	<script src="game.js"></script>
	<script src="visuals.js"></script>
	<script src="sliceAlgorithms.js"></script>
	<script src="leveldesign.js"></script>
	<script src="audio.js"></script>
	<link rel="stylesheet" type="text/css" href="interface.css">
	<link rel="stylesheet" type="text/css" href="visuals.css">
	<link rel="stylesheet" type="text/css" href="aboutvisuals.css">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<link rel="apple-touch-icon" sizes="57x57" href="favicon/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="favicon/apple-touch-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="favicon/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="favicon/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="favicon/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="favicon/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="favicon/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon-180x180.png">
	<link rel="icon" type="image/png" href="favicon/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="favicon/favicon-194x194.png" sizes="194x194">
	<link rel="icon" type="image/png" href="favicon/favicon-96x96.png" sizes="96x96">
	<link rel="icon" type="image/png" href="favicon/android-chrome-192x192.png" sizes="192x192">
	<link rel="icon" type="image/png" href="favicon/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="favicon/manifest.json">
	<link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#a0522d">
	<link rel="shortcut icon" href="favicon/favicon.ico">
	<meta name="msapplication-TileColor" content="#a0522d">
	<meta name="msapplication-TileImage" content="favicon/mstile-144x144.png">
	<meta name="msapplication-config" content="favicon/browserconfig.xml">
	<meta name="theme-color" content="#a0522d">
</head>
<body>
	<!-- Icons from Open Iconic: see /ICON-LICENSE -->
	<svg version="1.1" xmlns="http://www.w3.org/2000/svg" style="display:none">
		<defs>
			<symbol id="media-play" viewBox="0 0 8 8">
				<path d="M0 0v6l6-3-6-3z" transform="translate(1 1)"></path>
			</symbol>
			<symbol id="chevron-left" viewBox="0 0 8 8">
				<path d="M4 0l-4 4 4 4 1.5-1.5-2.5-2.5 2.5-2.5-1.5-1.5z" transform="translate(1)"></path>
			</symbol>
			<symbol id="media-pause" viewBox="0 0 8 8">
				<path d="M0 0v6h2v-6h-2zm4 0v6h2v-6h-2z" transform="translate(1 1)"></path>
			</symbol>
			<symbol id="reload" viewBox="0 0 8 8">
				<path d="M4 0c-2.201 0-4 1.799-4 4s1.799 4 4 4c1.104 0 2.092-.456 2.813-1.188l-.688-.688c-.54.548-1.289.875-2.125.875-1.659 0-3-1.341-3-3s1.341-3 3-3c.834 0 1.545.354 2.094.906l-1.094 1.094h3v-3l-1.188 1.188c-.731-.72-1.719-1.188-2.813-1.188z"></path>
			</symbol>
			<symbol id="arrow-thick-right" viewBox="0 0 8 8">
				<path d="M5 0v2h-5v2h5v2l3-3.031-3-2.969z" transform="translate(0 1)"></path>
			</symbol>
			<symbol id="volume-high" viewBox="0 0 8 8">
				<path d="M3.344 0l-1.344 2h-2v4h2l1.344 2h.656v-8h-.656zm1.656 1v1c.152 0 .313.026.469.063h.031c.86.215 1.5.995 1.5 1.938 0 .942-.64 1.722-1.5 1.938-.166.041-.338.063-.5.063v1c.258 0 .516-.035.75-.094 1.3-.325 2.25-1.508 2.25-2.906 0-1.398-.95-2.581-2.25-2.906-.234-.059-.492-.094-.75-.094zm0 2v2c.04 0 .134-.002.25-.031.433-.118.75-.507.75-.969 0-.446-.325-.819-.75-.938v-.031c-.005-.001-.025.002-.031 0-.043-.011-.111-.031-.219-.031z"></path>
			</symbol>
			<symbol id="volume-off" viewBox="0 0 8 8">
				<path d="M3.344 0l-1.344 2h-2v4h2l1.344 2h.656v-8h-.656z" transform="translate(2)"></path>
			</symbol>
			<symbol id="trash" viewBox="0 0 8 8">
				<path d="M3 0c-.55 0-1 .45-1 1h-1c-.55 0-1 .45-1 1h7c0-.55-.45-1-1-1h-1c0-.55-.45-1-1-1h-1zm-2 3v4.813c0 .11.077.188.188.188h4.625c.11 0 .188-.077.188-.188v-4.813h-1v3.5c0 .28-.22.5-.5.5s-.5-.22-.5-.5v-3.5h-1v3.5c0 .28-.22.5-.5.5s-.5-.22-.5-.5v-3.5h-1z"></path>
			</symbol>
		</defs>
	</svg>
	<audio id="music" src="audio/Vibe Ace.mp3"></audio>

	<header id="topbar">
		<button class="icon" id="btn-back">chevron-left</button>
	</header>
	<header id="gamebar">
		<span class="group1">
			<button class="icon" id="btn-menu">chevron-left</button>
			<span id="game-score">0</span>
		</span>
		<span class="group2">
			<button class="icon" id="btn-restart">reload</button>
			<button class="icon" id="btn-pause">media-pause</button>
		</span>
	</header>
	<div id="game" class="page">
		<h1 id="levelheader">&nbsp;</h1>
		<h2 id="leveltext">&nbsp;</h2>
		<svg id="field">
			<defs>
				<pattern id="frigate-blue" width="1" height="1">
					<image xlink:href="images/frigate_blue.svg" width="40" height="40"></image>
				</pattern>
				<pattern id="frigate-blue-thrust" width="1" height="1">
					<image xlink:href="images/frigate_blue_thrust.svg" width="40" height="40"></image>
				</pattern>
				<pattern id="frigate-red" width="1" height="1">
					<image xlink:href="images/frigate_red.svg" width="40" height="40"></image>
				</pattern>
				<pattern id="frigate-red-thrust" width="1" height="1">
					<image xlink:href="images/frigate_red_thrust.svg" width="40" height="40"></image>
				</pattern>
				<pattern id="cruiser-blue" width="1" height="1">
					<image xlink:href="images/cruiser_blue.svg" width="20" height="20"></image>
				</pattern>
				<pattern id="cruiser-blue-thrust" width="1" height="1">
					<image xlink:href="images/cruiser_blue_thrust.svg" width="20" height="20"></image>
				</pattern>
				<pattern id="cruiser-red" width="1" height="1">
					<image xlink:href="images/cruiser_red.svg" width="20" height="20"></image>
				</pattern>
				<pattern id="cruiser-red-thrust" width="1" height="1">
					<image xlink:href="images/cruiser_red_thrust.svg" width="20" height="20"></image>
				</pattern>
				<pattern id="fighter-blue" width="1" height="1">
					<image xlink:href="images/fighter_blue.svg" width="20" height="20"></image>
				</pattern>
				<pattern id="fighter-blue-thrust" width="1" height="1">
					<image xlink:href="images/fighter_blue_thrust.svg" width="20" height="20"></image>
				</pattern>
				<pattern id="fighter-red" width="1" height="1">
					<image xlink:href="images/fighter_red.svg" width="20" height="20"></image>
				</pattern>
				<pattern id="fighter-red-thrust" width="1" height="1">
					<image xlink:href="images/fighter_red_thrust.svg" width="20" height="20"></image>
				</pattern>
				<pattern id="hazardlines" width="40" height="40" patternUnits="userSpaceOnUse">
					<image xlink:href="images/hazardlines.svg" width="40" height="40"></image>
				</pattern>
			</defs>
			<g id="backdrop"></g>
		</svg>
	</div>
	<nav id="menu" class="page">
		<h1 id="game-title">&nbsp;</h1>
		<a id="btn-play">Play</a>
		<a id="btn-options">Options</a>
		<a id="btn-about">About</a>
		<a id="btn-exit">Exit</a>
	</nav>
	<div id="levels" class="page">
		<h1>Levels</h1>
		<div id="level-buttons"></div>
	</div>
	<div id="options" class="page">
		<h1>Options</h1>
		<hr>
		<h1>Reset game</h1>
		<p>
			<button id="btn-reset-game" class="icon">trash</button>
		</p>
		<hr>
		<h1>Music</h1>
		<p>
			<button id="btn-music-off" class="icon">volume-off</button>
			<button id="btn-music-on" class="icon">volume-high</button>
		</p>
	</div>
	<div id="about" class="page">
		<nav id="about-tabs">
			<a id="btn-about-instructions">Instructions</a>
			<a id="btn-about-info">Info</a>
			<a id="btn-about-algorithms" class="selected">Algorithms</a>
			<a id="btn-about-duality">Duality</a>
			<a id="btn-about-credits">Credits</a>
		</nav>
		<article>
			<section id="about-instructions"></section>
			<section id="about-info"></section>
			<section id="about-algorithms"></section>
			<section id="about-duality"></section>
			<section id="about-credits"></section>
		</article>
	</div>
	<div id="loader" class="page">
		<h1>Loading...</h1>
	</div>
	<div id="orient-guard" class="page">
		<h1>&nsbp;</h1>
		<h2>Please reorient your device.</h2>
	</div>
	<div id="pause-screen" class="page">
		<h1>- Paused -</h1>
		<p>Press here to resume</p>
	</div>
	<div id="lose-screen" class="page">
		<h1>- Game over -</h1>
		<p>Press here to try again</p>
	</div>
	<div id="win-screen" class="page">
		<h1>Congratulations!</h1>
		<p>
			<span class="label">Score:</span>
			<span id="win-score">0</span>
		</p>
		<p>
			<button id="btn-win-restart">Replay</button>
			<button id="btn-win-resume">Next</button>
		</p>
		<p>
			<button id="btn-win-menu">Levels</button>
		</p>
	</div>
	<script src="aboutdemo.js"></script>
	<script src="about.js"></script>
	<script>
		$(function()
		{
			var game = new Game(640, 360, 1000 / 60 /* 60 fps */),
				field = new Field('field', game);

			window.game = game;
			window.field = field;

			InitializeLevels(game.rect.shrink(20));
			game.on('update', field.updateLevel.bind(field));
			game.on('win', Winimation.bind(this, function()
			{
				$('#win-screen').show().trigger('score');
				localStorage.game = JSON.stringify(game.data);
			}));
			game.on('lose', function()
			{
				$('#lose-screen').show();
			});

			if (localStorage.game)
			{
				game.olddata = $.extend(true, {}, game.data);
				$.extend(true, game.data, JSON.parse(localStorage.game));
			}

			var stars = Array.apply(null, Array(200))
				.map(function() { return game.rect.randomPoint(); })
			;
			d3.select('#backdrop').selectAll('circle').data(stars).enter()
				.append('circle')
				.attr('cx', function (d) { return d.x; })
				.attr('cy', function (d) { return d.y; })
				.attr('r', function (d) { return Math.random() * 2; })
			;

			window.musicplayer = undefined;
			if (localStorage.music != 'off')
				StartMusic();

			/** /
			$(function(){$(function()
			{
				$('#btn-play').click();
				$($('#level-buttons a')[0]).click();
			})});
			/**/
		});

		function ResetGame()
		{
			delete localStorage.game;
			game.data = $.extend(true, {}, game.olddata);
		}

		function StartMusic()
		{
			try {
				window.musicplayer = new MusicPlayer('music')
					.loop(14.774, 59.097)
				;
			} catch (err) { console.warn('[Music] ' + err) }
		}
	</script>
	<script src="interface.js"></script>
</body>
</html>